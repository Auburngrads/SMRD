---
title: "`r SMRD2:::info('book')`"
subtitle: "`r SMRD2:::info('chapter9')`"
author: "`r SMRD2:::info('authors')`"
date: "`r Sys.Date()`"
output: 
  rmarkdown::html_vignette:
    css: my-vignette.css
    fig_caption: yes
vignette: >
  %\VignetteIndexEntry{echapter9}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, echo=FALSE}
SMRD2:::vinny()
library(SMRD2)
```

# In This Vignette...


## ShockAbsorber -- parametric bootstrap

The following is a test example that uses only a small number of simulations to test the routines. Note, that the nonparametric boot output structures can be quite large.

```{r}
ShockAbsorber.ld <- frame.to.ld(shockabsorber,
                                response.column = 1,
                                censor.column = 3,
                                time.units = "Kilometers")

ShockAbsorber.boot.p <- parametric.bootstrap(ShockAbsorber.ld,
                                             distribution = "Weibull",
                                             number.sim = 200)

plot(ShockAbsorber.boot.p)
plot(ShockAbsorber.boot.p, 
     simulate.parameters = TRUE, 
     parameter.sims = 500)

summary(ShockAbsorber.boot.p,
        inference.on = "parameter", 
        which = 1)

summary(ShockAbsorber.boot.p,
        inference.on = "parameter", 
        which = 2,
        do.compare = T)

summary(ShockAbsorber.boot.p,
        inference.on = "parameter", 
        which = 2)

summary(ShockAbsorber.boot.p,
        inference.on = "quantile",
        which = 0.1)

summary(ShockAbsorber.boot.p,
        inference.on = "probability", 
        which = 1000)


summary(ShockAbsorber.boot.p,
        inference.on = "parameter", 
        which = 2,
        do.compare = T)

summary(ShockAbsorber.boot.p,
        inference.on = "parameter", 
        which = 2,
        do.compare = F)

ShockAbsorber.boot.p2 <- parametric.bootstrap(ShockAbsorber.ld,
                                              number.sim = 200,
                                              distribution = "Weibull")

plot(ShockAbsorber.boot.p2)

plot(ShockAbsorber.boot.p2, 
     simulate.parameters = TRUE, 
     parameter.sims = 500)

summary(ShockAbsorber.boot.p2,
        inference.on = "parameter", 
        which = 1)

summary(ShockAbsorber.boot.p2,
        inference.on = "parameter", 
        which = 2)

summary(ShockAbsorber.boot.p2,
        inference.on = "quantile", 
        which = 0.1)

summary(ShockAbsorber.boot.p2,
        inference.on = "probability", 
        which = 1000)

summary(ShockAbsorber.boot.p2,
        inference.on = "parameter", 
        which = 2,
        do.compare = T)
```

## Shockabsorber -- nonparametric bootstrap

```{r}
ShockAbsorber.boot.np<- nonparametric.bootstrap(ShockAbsorber.ld,
                                                number.sim = 20)

plot(ShockAbsorber.boot.np)

summary(ShockAbsorber.boot.np, 
        compare = T)

compare.summary.boot.npar.npar.out(ShockAbsorber.boot.np)

ShockAbsorber.boot.np2 <- nonparametric.bootstrap(ShockAbsorber.ld,
                                                  number.sim = 200)

plot(ShockAbsorber.boot.np2)

summary(ShockAbsorber.boot.np2)

compare.summary.boot.npar.npar.out(ShockAbsorber.boot.np2)
```

## Bearing cage  -- parametric bootstrap

```{r}
BearingCage.boot.p <- parametric.bootstrap(BearingCage.ld,
                                           distribution = "Weibull",
                                           number.sim = 200)

plot(BearingCage.boot.p)

summary(BearingCage.boot.p,
        inference.on = "parameter", 
        which = 1)
summary(BearingCage.boot.p,
        inference.on = "parameter", 
        which = 2)
summary(BearingCage.boot.p,
        inference.on = "quantile", 
        which = 0.1)
summary(BearingCage.boot.p,
        inference.on = "probability", 
        which = 1000)
```

## Bearing cage -- nonparametric bootstrap

```{r}
BearingCage.boot.np <- nonparametric.bootstrap(BearingCage.ld,
                                               number.sim = 2000)

plot(BearingCage.boot.np)

summary(BearingCage.boot.np)

compare.summary.boot.npar.npar.out(BearingCage.boot.np)
```

## Bulb -- parametric bootstrap

```{r}
summary(bulb.ld)

bulb.boot.p <- parametric.bootstrap(bulb.ld,
                                    distribution = "normal",
                                    number.sim = 200)

plot(bulb.boot.p)

summary(bulb.boot.p,
        inference.on = "parameter", 
        which = 1)
summary(bulb.boot.p,
        inference.on = "parameter", 
        which = 2)
summary(bulb.boot.p,
        inference.on = "quantile", 
        which = 0.1)
summary(bulb.boot.p,
        inference.on = "probability", 
        which = 1000)
```

#Bulb -- nonparametric bootstrap

```{r}
bulb.boot.np <- nonparametric.bootstrap(bulb.ld,
                                        number.sim = 200)

plot(bulb.boot.np)
summary(bulb.boot.np,
        time.index = 200)

compare.summary.boot.npar.npar.out(bulb.boot.np,
                                   time.index = 200)
```

## Single distribution simulations

```{r}
SingleDistSim(number.sim = 10,
              distribution = "Weibull",
              theta = c(mu = 0.0, sigma = 1.0),
              sample.size = 10,
              censor.type = "None")

SingleDistSim(number.sim = 10,
              distribution = "Weibull",
              theta = c(mu = 0.0, sigma = 1.0),
              sample.size = 10,
              censor.type = "Type 1", 
              fail.fraction = 0.5)

SingleDistSim(number.sim = 10,
              distribution = "Weibull",
              theta = c(mu = 0.0, sigma = 1.0),
              sample.size = 10,
              censor.type = "Type 2",
              fail.number = 5)
```
